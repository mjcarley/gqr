\doxysection{GQR quadrature rules}
\label{group__gqr}\index{GQR quadrature rules@{GQR quadrature rules}}
\doxysubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \+\_\+gqr\+\_\+parameter\+\_\+t \textbf{ gqr\+\_\+parameter\+\_\+t}
\item 
typedef struct \+\_\+gqr\+\_\+rule\+\_\+t \textbf{ gqr\+\_\+rule\+\_\+t}
\item 
typedef gdouble($\ast$ \textbf{ gqr\+\_\+func\+\_\+t}) (gdouble t, gint i, gpointer data)
\item 
typedef gdouble($\ast$ \textbf{ gqr\+\_\+adapt\+\_\+func\+\_\+t}) (gdouble t, gint i, \textbf{ gqr\+\_\+parameter\+\_\+t} $\ast$p)
\end{DoxyCompactItemize}
\doxysubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \textbf{ gqr\+\_\+t} \{ \newline
\textbf{ GQR\+\_\+\+GAUSS\+\_\+\+LEGENDRE} = 1
, \textbf{ GQR\+\_\+\+GAUSS\+\_\+\+CHEBYSHEV\+\_\+1} = 2
, \textbf{ GQR\+\_\+\+GAUSS\+\_\+\+CHEBYSHEV\+\_\+2} = 3
, \textbf{ GQR\+\_\+\+GAUSS\+\_\+\+HERMITE} = 4
, \newline
\textbf{ GQR\+\_\+\+GAUSS\+\_\+\+LAGUERRE} = 5
, \textbf{ GQR\+\_\+\+GAUSS\+\_\+\+JACOBI} = 6
, \textbf{ GQR\+\_\+\+GAUSS\+\_\+\+LOGARITHMIC} = 1 $<$$<$ 8
, \textbf{ GQR\+\_\+\+GAUSS\+\_\+\+SINGULAR} = 1 $<$$<$ 9
, \newline
\textbf{ GQR\+\_\+\+GAUSS\+\_\+\+HYPERSINGULAR} = 1 $<$$<$ 10
, \textbf{ GQR\+\_\+\+GAUSS\+\_\+\+MULTISINGULAR} = 1 $<$$<$ 11
, \textbf{ GQR\+\_\+\+GAUSS\+\_\+\+GENERALIZED} = 1 $<$$<$ 12
 \}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\textbf{ gqr\+\_\+rule\+\_\+t} $\ast$ \textbf{ gqr\+\_\+rule\+\_\+alloc} (gint n)
\item 
\textbf{ gqr\+\_\+rule\+\_\+t} $\ast$ \textbf{ gqr\+\_\+rule\+\_\+realloc} (\textbf{ gqr\+\_\+rule\+\_\+t} $\ast$g, gint n)
\item 
gint \textbf{ gqr\+\_\+rule\+\_\+free} (\textbf{ gqr\+\_\+rule\+\_\+t} $\ast$g)
\item 
gint \textbf{ gqr\+\_\+rule\+\_\+write} (\textbf{ gqr\+\_\+rule\+\_\+t} $\ast$g, FILE $\ast$f)
\item 
gint \textbf{ gqr\+\_\+rule\+\_\+select} (\textbf{ gqr\+\_\+rule\+\_\+t} $\ast$g, \textbf{ gqr\+\_\+t} type, gint n, \textbf{ gqr\+\_\+parameter\+\_\+t} $\ast$p)
\item 
gint \textbf{ gqr\+\_\+rule\+\_\+scale} (\textbf{ gqr\+\_\+rule\+\_\+t} $\ast$g, gdouble a, gdouble b, gdouble $\ast$xbar, gdouble $\ast$dx)
\item 
gchar $\ast$ \textbf{ gqr\+\_\+rule\+\_\+name} (\textbf{ gqr\+\_\+t} type)
\item 
\textbf{ gqr\+\_\+t} \textbf{ gqr\+\_\+rule\+\_\+from\+\_\+name} (gchar $\ast$str, \textbf{ gqr\+\_\+parameter\+\_\+t} $\ast$p)
\item 
gpointer \textbf{ gqr\+\_\+pointer\+\_\+parse} (gchar $\ast$str)
\item 
gint \textbf{ gqr\+\_\+pointers\+\_\+list} (FILE $\ast$output, gboolean verbose)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
The GQR library computes Gaussian and Gaussian-\/type quadrature rules including some which handle singular integrands. A simple complete example of a code which integrates a function is\+: {\texttt{ example.\+c}}.

The functions described here are used to generate the quadrature rules and do basic operations such as reading them from and writing them to a file. 

\doxysubsection{Typedef Documentation}
\mbox{\label{group__gqr_ga3382cb8a6927c4cd5f31092237478186}} 
\index{GQR quadrature rules@{GQR quadrature rules}!gqr\_adapt\_func\_t@{gqr\_adapt\_func\_t}}
\index{gqr\_adapt\_func\_t@{gqr\_adapt\_func\_t}!GQR quadrature rules@{GQR quadrature rules}}
\doxysubsubsection{gqr\_adapt\_func\_t}
{\footnotesize\ttfamily gqr\+\_\+adapt\+\_\+func\+\_\+t}

A type for evaluating functions to be used in adaptive discretizations. Optionally, if {\itshape i} is negative, the function call should be interpreted as a request for the integral of the function between limits defined in the first two floating point entries in the parameter list {\itshape p}, with the function index taken as -\/(i+1).


\begin{DoxyParams}{Parameters}
{\em t} & evaluation point; \\
\hline
{\em i} & the index of the function to be evaluated; \\
\hline
{\em p} & parameter list to be passed to the function.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
value of the function $f_i(t)$, or the integral of $f_{-i-1}(t)$ if $i<0$. 
\end{DoxyReturn}
\mbox{\label{group__gqr_gae551353ed1a19dfab3090af9b28baad2}} 
\index{GQR quadrature rules@{GQR quadrature rules}!gqr\_func\_t@{gqr\_func\_t}}
\index{gqr\_func\_t@{gqr\_func\_t}!GQR quadrature rules@{GQR quadrature rules}}
\doxysubsubsection{gqr\_func\_t}
{\footnotesize\ttfamily gqr\+\_\+func\+\_\+t}

A type for evaluating integrands and their derivatives. 
\begin{DoxyParams}{Parameters}
{\em t} & evaluation point; \\
\hline
{\em i} & the order of derivative to be evaluated; \\
\hline
{\em data} & user data to be passed to the function.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
value of the $i$th derivative of the function at $t$. 
\end{DoxyReturn}
\mbox{\label{group__gqr_ga4512314849c794f1b2840a7135d663de}} 
\index{GQR quadrature rules@{GQR quadrature rules}!gqr\_parameter\_t@{gqr\_parameter\_t}}
\index{gqr\_parameter\_t@{gqr\_parameter\_t}!GQR quadrature rules@{GQR quadrature rules}}
\doxysubsubsection{gqr\_parameter\_t}
{\footnotesize\ttfamily \textbf{ gqr\+\_\+parameter\+\_\+t}}

A data structure containing parameters for quadrature rules which require them. \mbox{\label{group__gqr_ga89dca966e4378ceb2d146ffdbea4e272}} 
\index{GQR quadrature rules@{GQR quadrature rules}!gqr\_rule\_t@{gqr\_rule\_t}}
\index{gqr\_rule\_t@{gqr\_rule\_t}!GQR quadrature rules@{GQR quadrature rules}}
\doxysubsubsection{gqr\_rule\_t}
{\footnotesize\ttfamily \textbf{ gqr\+\_\+rule\+\_\+t}}

Data structure containing the nodes and weights of a quadrature rule. The rule is allocated using \doxyref{gqr\+\_\+rule\+\_\+alloc}{p.}{group__gqr_gad01b7fd22a2ad31b053c51783820613c} and initialized using \doxyref{gqr\+\_\+rule\+\_\+select}{p.}{group__gqr_ga9373a848b449bc2718f010e3edd831e3}. To transform the range of integration use \doxyref{gqr\+\_\+rule\+\_\+scale}{p.}{group__gqr_gabc8177171e6ba159904a20cb7e07be85}. 

\doxysubsection{Enumeration Type Documentation}
\mbox{\label{group__gqr_ga1f7bc8ccb4913fd0f8a5008c13069143}} 
\index{GQR quadrature rules@{GQR quadrature rules}!gqr\_t@{gqr\_t}}
\index{gqr\_t@{gqr\_t}!GQR quadrature rules@{GQR quadrature rules}}
\doxysubsubsection{gqr\_t}
{\footnotesize\ttfamily enum \textbf{ gqr\+\_\+t}}

A type defining the quadrature rules available. A quadrature rule is defined as a basic type possibly combined with a singularity. For example GQR\+\_\+\+GAUSS\+\_\+\+LEGENDRE $\vert$ GQR\+\_\+\+GAUSS\+\_\+\+HYPERSINGULAR specifies a Gauss-\/\+Legendre rule which handles singularities up to and including second order. Note that not all of these rules are implemented or going to be implemented. GQR will return an error message if you try to use an unimplemented rule. 

\doxysubsection{Function Documentation}
\mbox{\label{group__gqr_gad4dfc74c82c3c140f7e1463107479452}} 
\index{GQR quadrature rules@{GQR quadrature rules}!gqr\_pointer\_parse@{gqr\_pointer\_parse}}
\index{gqr\_pointer\_parse@{gqr\_pointer\_parse}!GQR quadrature rules@{GQR quadrature rules}}
\doxysubsubsection{gqr\_pointer\_parse()}
{\footnotesize\ttfamily gpointer gqr\+\_\+pointer\+\_\+parse (\begin{DoxyParamCaption}\item[{gchar $\ast$}]{str }\end{DoxyParamCaption})}

Parse a string which refers to a pointer. The main purpose of this function is to give user access to built-\/in functions for the generation of generalized quadratures.


\begin{DoxyParams}{Parameters}
{\em str} & a string to be parsed.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
a pointer to the data referred to by {\itshape str}, or NULL. 
\end{DoxyReturn}
\mbox{\label{group__gqr_ga385876e2b49927fb4547449832443d32}} 
\index{GQR quadrature rules@{GQR quadrature rules}!gqr\_pointers\_list@{gqr\_pointers\_list}}
\index{gqr\_pointers\_list@{gqr\_pointers\_list}!GQR quadrature rules@{GQR quadrature rules}}
\doxysubsubsection{gqr\_pointers\_list()}
{\footnotesize\ttfamily gint gqr\+\_\+pointers\+\_\+list (\begin{DoxyParamCaption}\item[{FILE $\ast$}]{output,  }\item[{gboolean}]{verbose }\end{DoxyParamCaption})}

List the built-\/in pointers recognized by \doxyref{gqr\+\_\+pointer\+\_\+parse}{p.}{group__gqr_gad4dfc74c82c3c140f7e1463107479452}


\begin{DoxyParams}{Parameters}
{\em output} & file stream to write to; \\
\hline
{\em verbose} & if TRUE, write detailed information about the built-\/in data.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success. 
\end{DoxyReturn}
\mbox{\label{group__gqr_gad01b7fd22a2ad31b053c51783820613c}} 
\index{GQR quadrature rules@{GQR quadrature rules}!gqr\_rule\_alloc@{gqr\_rule\_alloc}}
\index{gqr\_rule\_alloc@{gqr\_rule\_alloc}!GQR quadrature rules@{GQR quadrature rules}}
\doxysubsubsection{gqr\_rule\_alloc()}
{\footnotesize\ttfamily \textbf{ gqr\+\_\+rule\+\_\+t} $\ast$ gqr\+\_\+rule\+\_\+alloc (\begin{DoxyParamCaption}\item[{gint}]{n }\end{DoxyParamCaption})}

Allocate a Gaussian quadrature rule.


\begin{DoxyParams}{Parameters}
{\em n} & maximum length of rule (number of abscissae and weights).\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
newly allocated rule. 
\end{DoxyReturn}


Referenced by \textbf{ gqr\+\_\+rule\+\_\+bgr\+\_\+check()}, \textbf{ gqr\+\_\+rule\+\_\+realloc()}, and \textbf{ grule\+\_\+bgr()}.

\mbox{\label{group__gqr_gadc1a4139ccf724fb1a145501f817410d}} 
\index{GQR quadrature rules@{GQR quadrature rules}!gqr\_rule\_free@{gqr\_rule\_free}}
\index{gqr\_rule\_free@{gqr\_rule\_free}!GQR quadrature rules@{GQR quadrature rules}}
\doxysubsubsection{gqr\_rule\_free()}
{\footnotesize\ttfamily gint gqr\+\_\+rule\+\_\+free (\begin{DoxyParamCaption}\item[{\textbf{ gqr\+\_\+rule\+\_\+t} $\ast$}]{g }\end{DoxyParamCaption})}

Free all memory associated with a Gaussian quadrature rule.


\begin{DoxyParams}{Parameters}
{\em g} & rule to be freed.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success. 
\end{DoxyReturn}
\mbox{\label{group__gqr_ga4cf14c3801907dcf066aa354524434ed}} 
\index{GQR quadrature rules@{GQR quadrature rules}!gqr\_rule\_from\_name@{gqr\_rule\_from\_name}}
\index{gqr\_rule\_from\_name@{gqr\_rule\_from\_name}!GQR quadrature rules@{GQR quadrature rules}}
\doxysubsubsection{gqr\_rule\_from\_name()}
{\footnotesize\ttfamily \textbf{ gqr\+\_\+t} gqr\+\_\+rule\+\_\+from\+\_\+name (\begin{DoxyParamCaption}\item[{gchar $\ast$}]{str,  }\item[{\textbf{ gqr\+\_\+parameter\+\_\+t} $\ast$}]{p }\end{DoxyParamCaption})}

Parse a string description of a GQR rule, returning a \doxyref{gqr\+\_\+t}{p.}{group__gqr_ga1f7bc8ccb4913fd0f8a5008c13069143} description, intended for use in parsing command line options.


\begin{DoxyParams}{Parameters}
{\em str} & a string containing a description of a GQR rule, e.\+g. \char`\"{}\+GQR\+\_\+\+GAUSS\+\_\+\+LEGENDRE $\vert$ GQR\+\_\+\+GAUSS\+\_\+\+LOGARITHMIC\char`\"{}; \\
\hline
{\em p} & NULL or a \doxyref{gqr\+\_\+parameter\+\_\+t}{p.}{group__gqr_ga4512314849c794f1b2840a7135d663de} which will be filled with the data relevant to the selected rule type.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
a \doxyref{gqr\+\_\+t}{p.}{group__gqr_ga1f7bc8ccb4913fd0f8a5008c13069143} description of the rule in {\itshape str}, or an error code. 
\end{DoxyReturn}
\mbox{\label{group__gqr_ga8ebe215bbb435805c74fb0d6734f6081}} 
\index{GQR quadrature rules@{GQR quadrature rules}!gqr\_rule\_name@{gqr\_rule\_name}}
\index{gqr\_rule\_name@{gqr\_rule\_name}!GQR quadrature rules@{GQR quadrature rules}}
\doxysubsubsection{gqr\_rule\_name()}
{\footnotesize\ttfamily gchar $\ast$ gqr\+\_\+rule\+\_\+name (\begin{DoxyParamCaption}\item[{\textbf{ gqr\+\_\+t}}]{type }\end{DoxyParamCaption})}

Generate a string giving the name of the quadrature rule (Legendre, Hermite, etc.) and any singularities built into it.


\begin{DoxyParams}{Parameters}
{\em type} & a \doxyref{gqr\+\_\+t}{p.}{group__gqr_ga1f7bc8ccb4913fd0f8a5008c13069143} describing a quadrature rule.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
a string giving the name of rule {\itshape type}. 
\end{DoxyReturn}


Referenced by \textbf{ gqr\+\_\+rule\+\_\+select()}.

\mbox{\label{group__gqr_ga1ec121e1f0435bdc3fd99eca67e6bbea}} 
\index{GQR quadrature rules@{GQR quadrature rules}!gqr\_rule\_realloc@{gqr\_rule\_realloc}}
\index{gqr\_rule\_realloc@{gqr\_rule\_realloc}!GQR quadrature rules@{GQR quadrature rules}}
\doxysubsubsection{gqr\_rule\_realloc()}
{\footnotesize\ttfamily \textbf{ gqr\+\_\+rule\+\_\+t} $\ast$ gqr\+\_\+rule\+\_\+realloc (\begin{DoxyParamCaption}\item[{\textbf{ gqr\+\_\+rule\+\_\+t} $\ast$}]{g,  }\item[{gint}]{n }\end{DoxyParamCaption})}

Reallocate memory for a Gaussian quadrature rule to allow for a change in rule length.


\begin{DoxyParams}{Parameters}
{\em g} & \doxyref{gqr\+\_\+rule\+\_\+t}{p.}{group__gqr_ga89dca966e4378ceb2d146ffdbea4e272} to reallocate; \\
\hline
{\em n} & new maximum length of rule (number of abscissae and weights).\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
newly allocated rule. 
\end{DoxyReturn}


References \textbf{ gqr\+\_\+rule\+\_\+alloc()}.

\mbox{\label{group__gqr_gabc8177171e6ba159904a20cb7e07be85}} 
\index{GQR quadrature rules@{GQR quadrature rules}!gqr\_rule\_scale@{gqr\_rule\_scale}}
\index{gqr\_rule\_scale@{gqr\_rule\_scale}!GQR quadrature rules@{GQR quadrature rules}}
\doxysubsubsection{gqr\_rule\_scale()}
{\footnotesize\ttfamily gint gqr\+\_\+rule\+\_\+scale (\begin{DoxyParamCaption}\item[{\textbf{ gqr\+\_\+rule\+\_\+t} $\ast$}]{g,  }\item[{gdouble}]{a,  }\item[{gdouble}]{b,  }\item[{gdouble $\ast$}]{xbar,  }\item[{gdouble $\ast$}]{dx }\end{DoxyParamCaption})}

Set the scaling for a rule so that the integral is approximated by\+: $I\approx\Delta x \sum_{j=0}^{n}w_{j}f(x_{j})$ where $x=\bar{x}+\Delta x t_{j}$.


\begin{DoxyParams}{Parameters}
{\em g} & Gaussian quadrature rule; \\
\hline
{\em a} & lower limit of integration; \\
\hline
{\em b} & upper limit of integration; \\
\hline
{\em xbar} & $\bar{x}$; \\
\hline
{\em dx} & $\Delta x$.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success. 
\end{DoxyReturn}


Referenced by \textbf{ gqr\+\_\+finite\+\_\+part\+\_\+integral()}, and \textbf{ gqr\+\_\+rule\+\_\+bgr\+\_\+check()}.

\mbox{\label{group__gqr_ga9373a848b449bc2718f010e3edd831e3}} 
\index{GQR quadrature rules@{GQR quadrature rules}!gqr\_rule\_select@{gqr\_rule\_select}}
\index{gqr\_rule\_select@{gqr\_rule\_select}!GQR quadrature rules@{GQR quadrature rules}}
\doxysubsubsection{gqr\_rule\_select()}
{\footnotesize\ttfamily gint gqr\+\_\+rule\+\_\+select (\begin{DoxyParamCaption}\item[{\textbf{ gqr\+\_\+rule\+\_\+t} $\ast$}]{g,  }\item[{\textbf{ gqr\+\_\+t}}]{type,  }\item[{gint}]{n,  }\item[{\textbf{ gqr\+\_\+parameter\+\_\+t} $\ast$}]{p }\end{DoxyParamCaption})}

Fill a Gaussian quadrature rule with abscissae and weights of a chosen type.

You should exercise some caution in the Jacobi quadrature rules, since there are issues with calculating the nodes especially for weight function exponenents less than -\/1/2. You are advised to check the rule against a known solution, for example by checking that the sum of the weights correctly integrates the weighting function.


\begin{DoxyParams}{Parameters}
{\em g} & rule to fill; \\
\hline
{\em type} & a gqr\+\_\+t for the rule; \\
\hline
{\em n} & number of points in rule; \\
\hline
{\em p} & gqr\+\_\+parameter\+\_\+t of parameters for rule, or NULL for rules with no parameter (e.\+g. standard Legendre quadrature).\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success. 
\end{DoxyReturn}


References \textbf{ gqr\+\_\+rule\+\_\+name()}, and \textbf{ grule\+\_\+bgr()}.



Referenced by \textbf{ gqr\+\_\+rule\+\_\+bgr\+\_\+check()}, and \textbf{ grule\+\_\+bgr()}.

\mbox{\label{group__gqr_ga6a873d839cd487511f137d7926f33007}} 
\index{GQR quadrature rules@{GQR quadrature rules}!gqr\_rule\_write@{gqr\_rule\_write}}
\index{gqr\_rule\_write@{gqr\_rule\_write}!GQR quadrature rules@{GQR quadrature rules}}
\doxysubsubsection{gqr\_rule\_write()}
{\footnotesize\ttfamily gint gqr\+\_\+rule\+\_\+write (\begin{DoxyParamCaption}\item[{\textbf{ gqr\+\_\+rule\+\_\+t} $\ast$}]{g,  }\item[{FILE $\ast$}]{f }\end{DoxyParamCaption})}

Write the abscissae and weights of a Gaussian quadrature rule to a file.


\begin{DoxyParams}{Parameters}
{\em g} & Gaussian quadrature rule; \\
\hline
{\em f} & file stream to write to.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success. 
\end{DoxyReturn}
